# 5. 值类型与引用类型

## 值传递

值传递是指传递参数时，实参的值会被复制到形参中，==形参的修改不会影响到实参。==

## 引用传递

引用传递是将实参的地址传递给形参，==形参可以通过这个地址来修改实参。==

## 值类型

==int、float、bool、string、数组、struct==都是值类型，在函数调用的时候是值传递。

**变量直接存储值**，内存通常在栈中分配。

给新的变量赋值时(拷贝时)，为==深拷贝==，**==直接开辟新的内存地址存储值。==**

```go
func swap(x, y int) {
    x, y = y, x
}

func main() {
    a, b := 1, 2
    swap(a, b)
    fmt.Println(a, b) // 输出 1 2
}
```

## 引用类型

==指针、slice、map、chan、interface(接口)、func、映射(reflect)== 都是引用类型，在函数调用的时候进行的是引用传递。

**变量直接存储内存地址，这个地址存储值**。内存通常再堆上分配。

给新的变量赋值时(拷贝时)，为==浅拷贝==，==**新的变量通过指针指向原来的内存地址。可以使用copy关键字实现引用类型的深拷贝。**==

**==当如果没有任何一个变量引用这个地址时，这个地址就会被GC垃圾回收。==**

```go
func modifySlice(s []int) {
    s[0] = 100
}

func main() {
    s := []int{1, 2, 3}
    modifySlice(s)
    fmt.Println(s) // 输出 [100 2 3]
}
```

在实际开发中，==我们通常会将函数的形参声明为指针类型或切片等引用类型，这样可以避免复制大量的数据，在一定程度上提高程序的效率==。同时，在使用引用类型时需要注意，由于==多个变量共享同一个底层数据结构，可能会导致并发访问时的竞态条件问题，因此需要进行相应的锁定操作==。

